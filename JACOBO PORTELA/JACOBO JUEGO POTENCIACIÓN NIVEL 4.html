<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego de Potenciaci√≥n ‚Äì Potencia de una Potencia</title>
<style>
  body {
    background:#0f172a; color:white; font-family:Arial, sans-serif;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    height:100vh; margin:0;
  }
  h1 { margin-bottom:20px; color:#22d3ee; }

  #potencias {
    display:flex; gap:20px; margin:20px; font-size:40px;
  }
  sup { font-size:24px; color:#facc15; }

  .area {
    margin:15px; padding:20px; border:2px dashed #64748b; border-radius:6px;
    min-width:420px; min-height:160px; display:flex; gap:12px;
    justify-content:center; align-items:center; flex-wrap:wrap;
    font-size:30px; text-align:center;
    flex-direction:column;
  }
  .linea { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; align-items:center; }
  .potencia {
    padding:12px 18px; background:#3b82f6; border-radius:8px;
    cursor:grab; font-weight:bold; font-size:30px; user-select:none;
  }
  .symbol { font-size:32px; font-weight:bold; }
  .resultado {
    margin-top:20px; font-size:26px; color:#16a34a; font-weight:bold;
  }
  .final-box {
    margin-top:15px;
    padding:12px 20px;
    background:#16a34a;
    color:white;
    border-radius:8px;
    font-size:28px;
    font-weight:bold;
    box-shadow:0 0 12px rgba(22,163,74,0.7);
  }
  button {
    margin-top:20px; padding:10px 20px; font-size:18px;
    background:#22d3ee; border:none; border-radius:6px; cursor:pointer;
  }
</style>
</head>
<body>
  <h1>üî¢ Juego de Potenciaci√≥n ‚Äì Potencia de una Potencia</h1>

  <div id="potencias"></div>
  <div id="zonaFusion" class="area">Arrastra aqu√≠ la potencia</div>
  <div id="feedback" class="resultado">Arrastra la potencia dentro del par√©ntesis y luego aplica el exponente externo.</div>

  <button id="btnNueva">‚û°Ô∏è Nueva Operaci√≥n</button>

<script>
let base, exp1, exp2;
const potenciasDiv = document.getElementById("potencias");
const zonaFusion   = document.getElementById("zonaFusion");
const feedback     = document.getElementById("feedback");
const btnNueva     = document.getElementById("btnNueva");

btnNueva.addEventListener("click", nuevaOperacion);

function nuevaOperacion(){
  base = randInt(2,5);
  exp1 = randInt(2,4);
  exp2 = randInt(2,3);
  potenciasDiv.innerHTML = "";

  crearFicha(base,exp1,exp2);

  zonaFusion.innerHTML = "Arrastra aqu√≠ la potencia";
  feedback.textContent = "Aplica la propiedad: (a^m)^n = a^(m¬∑n)";
}

function crearFicha(b,e1,e2){
  const div = document.createElement("div");
  div.className = "potencia";
  div.innerHTML = `(${b}<sup>${e1}</sup>)<sup>${e2}</sup>`;
  div.draggable = true;
  div.dataset.base = b;
  div.dataset.exp1 = e1;
  div.dataset.exp2 = e2;

  div.addEventListener("dragstart", e=>{
    e.dataTransfer.setData("id", setTempId(div));
  });
  potenciasDiv.appendChild(div);
}

function setTempId(el){
  if(!el.id){
    el.id = 'f_'+Math.random().toString(36).slice(2);
  }
  return el.id;
}

zonaFusion.addEventListener("dragover", e=> e.preventDefault());
zonaFusion.addEventListener("drop", e=>{
  e.preventDefault();
  const id = e.dataTransfer.getData("id");
  const ficha = document.getElementById(id);

  if(ficha){
    zonaFusion.innerHTML="";
    const linea = document.createElement("div");
    linea.className="linea";
    zonaFusion.appendChild(linea);
    linea.appendChild(ficha);

    mostrarResultado(ficha);
  }
});

function mostrarResultado(ficha){
  let e1 = parseInt(ficha.dataset.exp1);
  let e2 = parseInt(ficha.dataset.exp2);
  let totalExp = e1*e2;
  let valor = Math.pow(base,totalExp);

  const linea = zonaFusion.querySelector(".linea");

  // paso 1: =
  setTimeout(()=>{
    const igual = document.createElement("div");
    igual.className="symbol"; igual.textContent="=";
    linea.appendChild(igual);
  },600);

  // paso 2: multiplicaci√≥n de exponentes
  setTimeout(()=>{
    const fusion = document.createElement("div");
    fusion.className="potencia";
    fusion.innerHTML = `${base}<sup>${e1}√ó${e2}</sup>`;
    fusion.style.background="#22c55e";
    linea.appendChild(fusion);
  },1200);

  // paso 3: flecha ‚Üí
  setTimeout(()=>{
    const flecha = document.createElement("div");
    flecha.className="symbol"; flecha.textContent="‚Üí";
    linea.appendChild(flecha);
  },1800);

  // paso 4: potencia final
  setTimeout(()=>{
    const res = document.createElement("div");
    res.className="potencia";
    res.innerHTML = `${base}<sup>${totalExp}</sup>`;
    linea.appendChild(res);
  },2400);

  // paso 5: multiplicaci√≥n repetida animada + resultado final
  setTimeout(()=>{
    const multLinea = document.createElement("div");
    multLinea.className="linea";
    multLinea.style.marginTop="15px";
    zonaFusion.appendChild(multLinea);

    let partes = [];
    let i = 0;
    let interval = setInterval(()=>{
      partes.push(base);
      multLinea.textContent = partes.join(" √ó ");
      if(partes.length===totalExp){
        multLinea.textContent += " = " + valor;

        const potFinal = document.createElement("div");
        potFinal.className="final-box";
        potFinal.innerHTML = `${base}<sup>${totalExp}</sup> = ${valor}`;
        zonaFusion.appendChild(potFinal);

        clearInterval(interval);
      }
    },600);

    feedback.textContent = "üéâ ¬°Excelente! Se multiplican los exponentes porque es potencia de una potencia.";
  },3000);
}

function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

nuevaOperacion();
</script>
</body>
</html>
