<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.4.0/fabric.min.js"></script>

    <title>Pizarra en Línea con Diapositivas de Imágenes</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- Agrega Font Awesome para los íconos -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">

<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.9.20/interactjs/interact.min.css">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.9.20/interactjs/interact.min.js"></script>
<script src="script.js"></script>





<style>
/* Estilo del botón "Mostrar Panel" */
#showPanelButton {
    background-color: #3498db;
    color: #fff;
    border: none;
    padding: 10px;
    margin: 10px;
    cursor: pointer;
    font-size: 20px;
    border-radius: 5px;
}

/* Estilo del panel de control */
#controlPanel {
    background-color: #efefef;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    position: absolute;
    top: 50px; /* Ajusta la posición vertical según tu diseño */
    right: 10px; /* Ajusta la posición horizontal según tu diseño */
    padding: 10px;
    display: none; /* Inicialmente oculto */
}
/* Estilo del botón "Anterior" */
#previousButton {
    background-color: #117e61;
}

/* Estilo del botón "Siguiente" */
#nextButton {
    background-color: #117e61;
}

/* Estilo del botón "Limpiar" */
#clearButton {
    background-color: #ac3333;
}

/* Estilo del botón "Guardar" */
#saveButton {
    background-color: #9e07cd;
}

/* Estilo del botón "Deshacer" */
#undoButton {
    background-color: #ab4444;
}

/* Estilo del botón "Rehacer" */
#redoButton {
    background-color: #ab4444;
}



/* Estilo del botón "Borrar Trazos" */
#clearDrawingButton {
    background-color: #bc9a03; /* Color de fondo del botón (puedes cambiarlo) */
}


/* Estilo del botón de carga de imagen */
#imageInput {
    background-color: #117e61;
    color: #fff;
    border: none;
    padding: 10px 20px;
    margin: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-size: 12px;
    border-radius: 5px;
    display: inline-block;
}

/* Estilo del botón de carga de imagen en hover */
#imageInput:hover {
    background-color: #2980b9;
}

/* Estilo de los botones ovalados */
button {
    background-color: #3498db;
    color: #fff;
    border: none;
    padding: 10px 20px;
    margin: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-size: 16px;
    border-radius: 25px; /* Valor alto para hacer que los botones sean ovalados */
}


    #timerDisplay {
    position: fixed;
    top: 16%;
    left: 50%;
    transform: translate(100%, -180%);
    text-align: left;
    font-size: 25px; /* Ajusta el tamaño del texto según tus preferencias */
}






/* Estilo del texto dentro del contenedor */
#textoContenedor p {
    font-size: 28px;
    color: #333;
    font-weight: bold;
    /* No es necesario centrar verticalmente ya que el contenedor se ajusta automáticamente */
}


    #textoContenedor {
        background-color: #ffffff;
        padding: 10px;
        margin-top: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        text-align: center;
        /* Centra el texto horizontalmente */
        position: relative; /* Permite posicionar elementos hijos relativos a este contenedor */
    }

    #logoContainer {
        position: absolute;
        top: 0; /* Ajusta la posición vertical según tu diseño */
        right: 0; /* Coloca el logotipo en el lado derecho del contenedor */
    }

    #logoContainer img {
        width: 300px; /* Ajusta el ancho del logotipo según tus necesidades */
        height: auto; /* Mantiene la proporción original */
    }





    body {
        background-image: url('https://cdn.pixabay.com/photo/2018/04/06/00/25/trees-3294681_640.jpg'); /* Ruta de la imagen de fondo */
        background-size: cover; /* Ajusta el tamaño de la imagen para cubrir todo el fondo */
        background-repeat: no-repeat; /* Evita la repetición de la imagen */
        background-attachment: fixed; /* Fija la imagen en su lugar mientras se desplaza la página */
    }
    
    /* Otras reglas de estilo CSS aquí... */

    #showPanelButton {
    position: absolute; /* Asegúrate de que el botón tenga una posición absoluta o fija */
    top: 10px; /* Ajusta la posición vertical según tu diseño */
    right: 10px; /* Ajusta la posición horizontal según tu diseño */
    /* Resto de tus estilos... */
}

#controlPanel {
    position: absolute;
    top: 50px; /* Ajusta la posición vertical según tu diseño */
    right: 10px; /* Ajusta la posición horizontal según tu diseño */
    display: none;
    /* Resto de tus estilos... */
}

/* Estilo para el rango de tamaño del pincel */
#brushSizeInput {
      width: 10%; /* Modifica el ancho a tu preferencia, por ejemplo, 80% del contenedor */
    }

/* Estilo para el selector de color */
#colorPicker {
      width: 25px; /* Cambia el valor del ancho según tus preferencias */
    }


 
/* Estilo del botón "Elegir un Nombre al Azar" */
#pickRandomStudentButton {
    background-color: #3498db;
    color: #fff;
    border: none;
    padding: 10px 20px;
    margin: 10px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 50px;
    font-weight: bold; /* Texto en negrita */
}

/* Estilo del resultado del nombre al azar */
#randomStudentResult {
    font-size: 35px;
    color: #333;
    margin: 10px;
    text-align: center;
    font-weight: bold; /* Texto en negrita */
}

/* Estilo del contenedor ESTUDIANTE AL AZAR */
#studentContainer {
    background-color: #f2f2f2;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 10px;
    margin: 20px;
}

/* Estilo del párrafo dentro del contenedor*/
#studentContainer p {
    font-weight: bold; /* Texto en negrita */
    margin-bottom: 10px;
    color: #ffffff; /* Cambia el color  que desees */
}

/* Estilo del textarea dentro del contenedor */
#studentNamesInput {
    width: 10%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    margin-bottom: 10px;
}

/* Estilo de los botones dentro del contenedor */
#studentContainer button {
    background-color: #3498db;
    color: #fff;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 5px;
    margin-right: 10px;
}

/* Estilo del botón "Elegir un Nombre al Azar" */
#pickRandomStudentButton {
    background-color: #117e61; /* Cambia el color si deseas */
}

.upload-text {
    color: #fff; /* Cambia el color del texto a blanco */
}



.upload-label {
    color: #02f6fa; /* Cambia el color del texto*/
}

.upload-label i {
    font-size: 24px; /* Ajusta el tamaño según tus preferencias */
}


.upload-label i {
    margin-left: 13px; /* Agrega un margen a la derecha del primer ícono para separarlos */
}


/* Estilo del botón "Iniciar Cronómetro" */
#startTimerButton {
    background-color: #016fb9;
}

/* Estilo del botón "Reiniciar Cronómetro" */
#resetTimerButton {
    background-color: #9d3501;
}



/* Estilos para el campo de entrada de tiempo */
#timerInput {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    width: 150px; /* Ajusta el ancho según tus preferencias */
    margin-right: 10px;
}




#startTimer {
    background: none;
    border: none;
    font-size: 24px;
    margin-right: 10px; /* Espacio entre el botón y otros elementos */
    cursor: pointer; /* Cambia el cursor al pasar por encima */
    color: #02f6fa; /* Color del icono */
}

#startTimer:hover {
    color: #f9e104; /* Cambia el color del icono al pasar el cursor por encima */
}


#pauseTimer, #resetTimer {
    background: none;
    border: none;
    font-size: 24px;
    margin-right: 10px; /* Espacio entre los botones y otros elementos */
    cursor: pointer; /* Cambia el cursor al pasar por encima */
    color: #02f6fa; /* Color del icono */
}

#pauseTimer:hover, #resetTimer:hover {
    color: #f9e104; /* Cambia el color del icono al pasar el cursor por encima */
}


#timer {
    font-size: 24px; /* Tamaño de fuente del temporizador */
    color: #333; /* Color del texto */
    background-color: transparent; /* Fondo transparente */
    padding: 10px; /* Espaciado interno para el contenido */
    border: 1px solid #ccc; /* Borde alrededor del temporizador */
    border-radius: 5px; /* Borde redondeado */
    text-align: center; /* Alineación del texto en el centro */
    width: 180px; /* Ancho del temporizador (ajusta según tus necesidades) */
    text-align: center; /* Para centrar horizontalmente */
    margin: 0 auto; /* Margen automático a la izquierda y derecha para centrar */
    position: absolute; /* Posición absoluta para permitir el arrastre */
    cursor: move; /* Cursor de agarre para indicar que se puede arrastrar */
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    display: none; /* Oculta el temporizador por defecto */




}


#timer {
    font-size: 24px; /* Tamaño de fuente */
    font-weight: bold; /* Texto en negrita */
    color: #ffffff; /* Color del texto */
}

#minutes,
#seconds {
    background-color: #3498db; /* Color de fondo de los dígitos */
    color: #fff; /* Color del texto de los dígitos */
    padding: 5px 10px; /* Espaciado alrededor de los dígitos */
    border-radius: 5px; /* Bordes redondeados de los dígitos */
}

#minutes, #seconds {
    margin: 0 5px; /* Agrega un espacio de 5px a la izquierda y a la derecha de los dígitos */
}

#timerDisplay {
    position: fixed;
    top: 16%;
    left: 50%;
    transform: translate(100%, -180%);
    text-align: left;
    font-size: 25px; /* Ajusta el tamaño del texto según tus preferencias */
}

#timer span {
    font-weight: bold;
    margin: 0 5px;
}

#timer.time-up {
    background-color: #ff6b6b; /* Cambia el color de fondo cuando el tiempo se agota */
    color: white;
}


#timerInput {
    font-size: 24px;
    cursor: pointer; /* Cambia el cursor al pasar por encima */
    color: #02f6fa; /* Color del ícono */
    margin-right: 10px; /* Espacio entre el campo de entrada y otros elementos */
}

#timerInput:hover {
    color: #f9e104; /* Cambia el color del ícono al pasar el cursor por encima */
}


#timerInput {
    font-size: 20px;
    cursor: pointer; /* Cambia el cursor al pasar por encima */
    color: #02f6fa; /* Color del ícono */
    background-color: #000; /* Color de fondo del campo de entrada */
    padding: 5px 10px; /* Espaciado interno para el contenido */
    border: 1px solid #ccc; /* Borde alrededor del campo de entrada */
    border-radius: 5px; /* Borde redondeado */
    margin-right: 10px; /* Espacio entre el campo de entrada y otros elementos */
    width: 50px; /* Ancho del campo de entrada (ajusta según tus necesidades) */
    text-align: center; /* Alineación del texto en el centro */
}

#timerInput::after {
    content: " (s)"; /* Agrega "(s)" después del contenido del campo de entrada */
}

#timerInput:hover {
    color: #fffb00; /* Cambia el color del ícono al pasar el cursor por encima */
    background-color: #333; /* Cambia el color de fondo al pasar el cursor por encima */
}


#clearButton, #saveButton, #clearDrawingButton, #undoButton, #redoButton, #previousButton, #nextButton {
    background: none;
    border: none;
    font-size: 24px;
    margin-right: 10px; /* Espacio entre los botones y otros elementos */
    cursor: pointer; /* Cambia el cursor al pasar por encima */
    color: #02f6fa; /* Color del icono */
}

#clearButton:hover, #saveButton:hover, #clearDrawingButton:hover, #undoButton:hover, #redoButton:hover, #previousButton:hover, #nextButton:hover {
    color: #f9e104; /* Cambia el color del icono al pasar el cursor por encima */
}






.icon-button {
        background-color: #037fd2; /* Puedes cambiar este color a tu preferencia */
        color: #ffffff; /* Color del texto en el botón */
        border: none;
        padding: 10px 20px;
        cursor: pointer;
    }

    .icon-button:hover {
        background-color: #06fafa; /*  Cambia el color al pasar el ratón sobre el botón */
        color: #000000; /* Cambia el color del texto al pasar el ratón sobre el botón */
    }


/* LÁPIZ BORRADOR POR DEFECTO NUEVAS PIZARRAS*/

/* Estilo para el rectángulo */









</style>










</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.5.0/fabric.min.js"></script>
<script src="script.js"></script>
<body>
   

   
    
        
   
    

    <div class="file-upload-container">

        <button id="fullScreenButton" onclick="toggleFullScreen()"><i class="fas fa-expand"></i></button> <label for="imageInput" class="upload-label">
            <i class="fas fa-upload"></i> 
        </label>
        <input type="file" id="imageInput" accept="image/*" multiple style="display: none;">
        
        
        
<div id="timer" style="display: none;">
    Tiempo restante: <br><br><span id="minutes"></span>:<span id="seconds"></span>
</div>

        
     
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        
        
        
     
    </div>
        
      
    

   
      

     

   <canvas id="whiteboard" width="1330" height="900"></canvas><br>
   
    
   
    
  <div>
    <input type="color" id="colorPicker">
    <input type="range" id="brushSizeInput" min="1" max="10" value="5"> <!-- Rango de tamaño del pincel --> 
    <button id="clearDrawingButton"><i class="fas fa-eraser"></i></button>
    <button id="undoButton"><i class="fas fa-undo"></i></button>
    <button id="redoButton"><i class="fas fa-redo"></i></button>
    <button id="clearButton"><i class="fas fa-trash"></i></button>
    <button id="saveButton"><i class="fas fa-camera"></i></button>
    
     <!-- Botones para navegación de imágenes -->
     <button id="previousButton"><i class="fas fa-chevron-left"></i></button>
     <button id="nextButton"><i class="fas fa-chevron-right"></i></button>
        <!-- Botón de transición con ícono -->
    <button id="transitionButton" class="icon-button">
        <i class="fas fa-play"></i> Transición
    </button>
  <!-- Agrega este campo de entrada para la duración de la transición -->
<input type="number" id="transitionDuration" placeholder="Duración en segundos" />
<button id="startTransitionButton"></button>

     <input type="text" id="timerInput" placeholder="Tiempo (segundos)">
     <button id="startTimer"><i class="fas fa-clock"></i></button>
     <button id="pauseTimer"><i class="fas fa-pause"></i></button>
      <!-- Agrega un botón de reinicio -->
     <button id="resetTimer"><i class="fas fa-sync"></i></button>
 
   
  </div>
  

    <button id="showPanelButton">☰</button>

   
    <div id="controlPanel">
        
        
          
        <input type="number" id="timerInput" placeholder="Tiempo (s)">
        <button id="startTimerButton"><i class="fas fa-clock"></i></button>
        <button id="resetTimerButton"><i class="fas fa-sync"></i></button>
            

        
        <div class="controls">
           
            
      
            
            
        
            
            
           
            <STrong><div id="timerDisplay" style="color: rgb(4, 73, 129);">Tiempo restante: <span id="timerValue">0</span> segundos</div></STrong>

           
       
        

     
        <audio id="timerSound">
            <source src="sound.mp3" type="audio/mpeg">
            Tu navegador no soporta el elemento de audio.
        </audio>
        
        

        
<br><br><br><br>


    
        
    


    <script src="script.js"></script>



    <div>
        <p id="randomStudentResult"></p>
        <textarea id="studentNamesInput" placeholder="Ingrese los nombres de los estudiantes uno por línea"></textarea>
        <button id="addStudentsButton"><i class="fas fa-list-ul"></i></button>
        <button id="pickRandomStudentButton"><i class="fas fa-random"></i></button>
        

    </div>
           


        </div>
        <div id="textoContenedor">
            <p>PROGRAMA TRUEQUE AMBIENTAL LOS TUTORES</p>
    
            <div id="logoContainer"> <img src="https://www.fedusocial.org/LOGO%20PARTNERS%20SURVEY.png" alt="Logotipo">
        


    </div>
    <!-- Resto de tu contenido aquí -->
    <br><br><br>

   


<script>
// Obtén referencias a los elementos del botón y el panel de control
const showPanelButton = document.getElementById('showPanelButton');
const controlPanel = document.getElementById('controlPanel');

// Agrega un manejador de eventos al botón "Mostrar Panel"
showPanelButton.addEventListener('click', () => {
    if (controlPanel.style.display === 'none') {
        controlPanel.style.display = 'block'; // Muestra el panel de control
    } else {
        controlPanel.style.display = 'none'; // Oculta el panel de control
    }
});



const canvas = document.getElementById('whiteboard');
const ctx = canvas.getContext('2d');
const imageInput = document.getElementById('imageInput');
const previousButton = document.getElementById('previousButton');
const nextButton = document.getElementById('nextButton');
const clearButton = document.getElementById('clearButton');
const saveButton = document.getElementById('saveButton');
const undoButton = document.getElementById('undoButton');
const redoButton = document.getElementById('redoButton');
// Obtén referencias a los elementos relacionados con el cronómetro
const timerInput = document.getElementById('timerInput');
const startTimerButton = document.getElementById('startTimerButton');
const resetTimerButton = document.getElementById('resetTimerButton');
const timerDisplay = document.getElementById('timerDisplay');
const timerValue = document.getElementById('timerValue');





canvas.width = 1400; // Ancho del lienzo
canvas.height = 630; // Alto del lienzo

let imageLoaded = false;
let isDrawing = false;
let lastX = 0;
let lastY = 0;
let brushColor = '#000000'; // Color del pincel
let brushSize = 5; // Tamaño del pincel
let drawingHistory = [];
let historyIndex = -1;
let currentImageIndex = -1;
let images = [];
let currentImage = new Image();
let timerInterval; // Variable para el intervalo del cronómetro
let remainingTime = 0; // Tiempo restante en segundos
let soundPlayed = false; // Bandera para controlar si se ha reproducido el sonido
let undoHistory = [];
let redoHistory = [];



// Función para guardar el dibujo como imagen

saveButton.addEventListener('click', () => {
    saveDrawing();
});


function saveDrawing() {
    console.log("Guardando el dibujo"); // Agregar mensaje de depuración
    const dataURL = canvas.toDataURL('image/png');
    const a = document.createElement('a');
    a.href = dataURL;
    a.download = 'drawing.png';
    a.click();
}







// Obtén la URL de la imagen dibujada en el lienzo
const dataURL = canvas.toDataURL('image/png');

    








// Función para cargar una imagen
function loadNewImage(file) {
    if (file) {
        const reader = new FileReader();
        reader.onload = function (event) {
            currentImage.src = event.target.result;
            currentImage.onload = function () {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(currentImage, 0, 0, canvas.width, canvas.height);
                imageLoaded = true;
            };
        };
        reader.readAsDataURL(file);
    }
}

// Función para deshacer el último paso
clearButton.addEventListener('click', () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawingHistory = [];
    historyIndex = -1;
    imageLoaded = false;
    imageInput.value = ''; // Limpiar el input de carga de imagen
    images = []; // Limpiar la lista de imágenes
    currentImageIndex = -1;
});



// Arrays para almacenar el historial de dibujo para Deshacer y Rehacer
const historialDeshacer = [];
const historialRehacer = [];

// Agrega un manejador de eventos al botón Deshacer
undoButton.addEventListener('click', () => {
    if (historialDeshacer.length > 0) {
        const ultimoEstado = historialDeshacer.pop();
        historialRehacer.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
        ctx.putImageData(ultimoEstado, 0, 0);
    }
});

// Agrega un manejador de eventos al botón Rehacer
redoButton.addEventListener('click', () => {
    if (historialRehacer.length > 0) {
        const siguienteEstado = historialRehacer.pop();
        historialDeshacer.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
        ctx.putImageData(siguienteEstado, 0, 0);
    }
});

// Función para guardar el estado actual del lienzo para Deshacer
function guardarEstadoDeshacer() {
    historialDeshacer.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
    // Borra el historial de Rehacer cuando se realiza un nuevo dibujo
    historialRehacer.length = 0;
}

// Conecta esta función con tu lógica de dibujo para guardar estados antes de cada cambio
canvas.addEventListener('mousemove', () => {
    if (isDrawing) {
        guardarEstadoDeshacer();
        // ... tu código de dibujo aquí ...
    }
});



// Manejador de eventos para cargar imágenes
imageInput.addEventListener('change', (e) => {
    images = Array.from(e.target.files);
    currentImageIndex = 0;
    loadNewImage(images[currentImageIndex]);
});


//-----------FUNCIONES DEL LÁPIZ --------------------------//

// Agregar un manejador de eventos para el clic del mouse (mousedown)
canvas.addEventListener('mousedown', (e) => {
    isDrawing = true;
    [lastX, lastY] = [e.clientX - canvas.getBoundingClientRect().left, e.clientY - canvas.getBoundingClientRect().top];
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
});

// Agregar un manejador de eventos para el movimiento del mouse (mousemove)
canvas.addEventListener('mousemove', (e) => {
    if (isDrawing) {
        const x = e.clientX - canvas.getBoundingClientRect().left;
        const y = e.clientY - canvas.getBoundingClientRect().top;
        ctx.strokeStyle = brushColor;
        ctx.lineWidth = brushSize;
        ctx.lineTo(x, y);
        ctx.stroke();
        [lastX, lastY] = [x, y];
    }
});

// Agregar un manejador de eventos para el final del dibujo (mouseup)
canvas.addEventListener('mouseup', () => {
    isDrawing = false;
    ctx.closePath();
    // Guardar el trazo actual en el historial
    const drawingData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    drawingHistory.push(drawingData);
    historyIndex = drawingHistory.length - 1;
});

// Agregar un manejador de eventos para salir del área de dibujo (mouseout)
canvas.addEventListener('mouseout', () => {
    isDrawing = false;
});

//--------------------------------------------------------------------------//

//-----------BORRAR DIBUJO--------------------------//
// Obtén referencia al botón "Borrar Trazos"
const clearDrawingButton = document.getElementById('clearDrawingButton');

// Agregar un manejador de eventos al botón "Borrar Trazos"
clearDrawingButton.addEventListener('click', clearDrawing);

// Función para borrar los trazos del lápiz sin afectar la imagen
function clearDrawing() {
    // Borrar los trazos del lápiz
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Redraw la imagen actual si está cargada
    if (imageLoaded) {
        ctx.drawImage(currentImage, 0, 0, canvas.width, canvas.height);
    }
    
    // Restablecer el historial de dibujo
    drawingHistory = [];
    historyIndex = -1;
}

//-------------------------------------------------//









// Manejadores de eventos para la navegación de imágenes
previousButton.addEventListener('click', () => {
    if (currentImageIndex > 0) {
        currentImageIndex--;
        loadNewImage(images[currentImageIndex]);
    }
});

nextButton.addEventListener('click', () => {
    if (currentImageIndex < images.length - 1) {
        currentImageIndex++;
        loadNewImage(images[currentImageIndex]);
    }
});


// Obtén referencias a los elementos de color y tamaño del pincel
const colorPicker = document.getElementById('colorPicker');
const brushSizeInput = document.getElementById('brushSizeInput');






function updateTimerDisplay() {
    timerValue.textContent = remainingTime;
}


startTimerButton.addEventListener('click', () => {
    const newTime = parseInt(timerInput.value);
    if (!isNaN(newTime) && newTime > 0) {
        clearInterval(timerInterval); // Detener el cronómetro anterior
        remainingTime = newTime;
        updateTimerDisplay();
        soundPlayed = false; // Restablecer soundPlayed a false al iniciar el cronómetro


// Iniciar el nuevo cronómetro
timerInterval = setInterval(() => {
            if (remainingTime > 0) {
                remainingTime--;
                updateTimerDisplay();
            } else {
                clearInterval(timerInterval);
            }
        }, 1000);
    }
});

     

resetTimerButton.addEventListener('click', () => {
    clearInterval(timerInterval);
    remainingTime = 0;
    timerInput.value = ''; // Limpiar el input de configuración
    updateTimerDisplay();
});

// Llamar a updateTimerDisplay inicialmente para mostrar "0 segundos"
updateTimerDisplay();



// Función para actualizar la visualización del cronómetro
function updateTimerDisplay() {
    timerValue.textContent = remainingTime;

    if (remainingTime === 0 && !soundPlayed) {
        // Reproducir el sonido cuando el cronómetro llega a cero
        const timerSound = document.getElementById('timerSound');
        timerSound.play();
        soundPlayed = true;
    }

    if (remainingTime < 0) {
        clearInterval(timerInterval);
        timerValue.textContent = '0';
    }
}



function loadNewImage(file) {
    if (file) {
        const fileType = file.type;
        if (fileType === 'image/jpeg' || fileType === 'image/png') {
            // Si es una imagen, carga como antes
            const reader = new FileReader();
            reader.onload = function (event) {
                currentImage.src = event.target.result;
                currentImage.onload = function () {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(currentImage, 0, 0, canvas.width, canvas.height);
                    imageLoaded = true;
                };
            };
            reader.readAsDataURL(file);
        } else if (fileType === 'application/pdf') {
            // Si es un PDF, utiliza PDF.js para mostrarlo
            // Debes incluir PDF.js en tu proyecto
            const pdfUrl = URL.createObjectURL(file);
            PDFJS.getDocument(pdfUrl).promise.then(function (pdf) {
                pdf.getPage(1).then(function (page) {
                    const viewport = page.getViewport({ scale: 1 });
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    page.render({
                        canvasContext: ctx,
                        viewport: viewport,
                    });
                });
            });
        }
    }
}









// Función para mostrar el selector de color al hacer clic en el ícono
function updateColor() {
      var colorPicker = document.getElementById("colorPicker");
      colorPicker.click(); // Abre el selector de color
    }


// GROSOR DEL TRAZO ----------

// Agrega manejadores de eventos para cambios en el color y el tamaño del pincel
colorPicker.addEventListener('input', (e) => {
    brushColor = e.target.value;
    ctx.strokeStyle = brushColor;
});

brushSizeInput.addEventListener('input', (e) => {
    brushSize = e.target.value;
    ctx.lineWidth = brushSize;
});


// ---------------- ----------






function drawLine(e) {
  if (!isDrawing) return;
  endX = e.clientX - canvas.getBoundingClientRect().left;
  endY = e.clientY - canvas.getBoundingClientRect().top;
  context.clearRect(0, 0, canvas.width, canvas.height);
  context.beginPath();
  context.moveTo(startX, startY);
  context.lineTo(endX, endY);
  context.stroke();
  
  // Almacena el trazo en el historial de deshacer
  undoHistory.push(context.getImageData(0, 0, canvas.width, canvas.height));
}


    function stopDrawing() {
      isDrawing = false;
      canvas.removeEventListener('mousemove', drawLine);
    }


// Obtén referencias a los elementos HTML
const studentNamesInput = document.getElementById('studentNamesInput');
const addStudentsButton = document.getElementById('addStudentsButton');
const pickRandomStudentButton = document.getElementById('pickRandomStudentButton');
const randomStudentResult = document.getElementById('randomStudentResult');

// Arreglo para almacenar los nombres de los estudiantes
const studentNames = [];

// Agregar estudiantes al arreglo cuando se hace clic en el botón "Agregar Estudiantes"
addStudentsButton.addEventListener('click', () => {
    const inputText = studentNamesInput.value.trim();
    if (inputText !== '') {
        const newStudents = inputText.split('\n').map(name => name.trim());
        studentNames.push(...newStudents);
        studentNamesInput.value = ''; // Limpiar el área de texto
    }
});

// Elegir un nombre al azar cuando se hace clic en el botón "Elegir un Nombre al Azar"
pickRandomStudentButton.addEventListener('click', () => {
    if (studentNames.length > 0) {
        const randomIndex = Math.floor(Math.random() * studentNames.length);
        const randomStudent = studentNames[randomIndex];
        randomStudentResult.textContent = `El estudiante seleccionado al azar es: ${randomStudent}`;
    } else {
        randomStudentResult.textContent = 'No hay estudiantes en la lista.';
    }
});

// Agregar un manejador de eventos al botón "Limpiar"
document.getElementById('clearButton').addEventListener('click', function () {
    // Limpia el lienzo de dibujo
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawingHistory = [];
    historyIndex = -1;
    imageLoaded = false;
    imageInput.value = '';
    images = [];
    currentImageIndex = -1;

    // Borra el estudiante elegido al azar
    document.getElementById('randomStudentResult').textContent = '';
});



    // PANTALLA COMPLETA

// Función para activar o desactivar la pantalla completa
function toggleFullScreen() {
    const element = document.documentElement; // Elemento raíz (todo el documento)

    if (document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement) {
        // Salir de pantalla completa si ya está en pantalla completa
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        }
    } else {
        // Entrar en pantalla completa si no está en pantalla completa
        if (element.requestFullscreen) {
            element.requestFullscreen();
        } else if (element.mozRequestFullScreen) {
            element.mozRequestFullScreen();
        } else if (element.webkitRequestFullscreen) {
            element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
        }
    }
}

// Agrega un manejador de eventos al documento para detectar cambios en el estado de pantalla completa
document.addEventListener('fullscreenchange', handleFullScreenChange);
document.addEventListener('mozfullscreenchange', handleFullScreenChange);
document.addEventListener('webkitfullscreenchange', handleFullScreenChange);

// Función para manejar cambios en el estado de pantalla completa
function handleFullScreenChange() {
    const fullScreenButton = document.getElementById('fullScreenButton');

    if (document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement) {
        // Actualiza el botón cuando se activa la pantalla completa
        fullScreenButton.innerHTML = '<i class="fas fa-compress"></i>';
    } else {
        // Actualiza el botón cuando se sale de la pantalla completa
        fullScreenButton.innerHTML = '<i class="fas fa-expand"></i>';
    }
}



function startTimer() {
    const timerButton = document.getElementById('startTimer');
    const resetButton = document.getElementById('resetTimer');
    const pauseButton = document.getElementById('pauseTimer'); // Agrega el botón de pausa
    const timerInput = document.getElementById('timerInput');
    const timerDisplay = document.getElementById('timer');
    const minutesDisplay = document.getElementById('minutes');
    const secondsDisplay = document.getElementById('seconds');

    let countdown;
    let remainingTime = 180; // Por defecto, 3 minutos (180 segundos)
    let isPaused = false; // Variable para controlar si el temporizador está pausado

    updateDisplay();

    timerButton.addEventListener('click', () => {
        const time = parseInt(timerInput.value, 10); // Obtiene el tiempo en segundos
        if (isNaN(time) || time < 1) {
            alert('Ingresa un valor válido para el temporizador (mínimo 1 segundo).');
            return;
        }

        remainingTime = time;
        updateDisplay();

        clearInterval(countdown);

        countdown = setInterval(function () {
            if (remainingTime <= 0) {
                clearInterval(countdown);
                alert('¡Tiempo agotado!');
                return;
            }

            if (!isPaused) {
                remainingTime--;
                updateDisplay();
            }
        }, 1000); // Actualiza cada segundo
    });

    resetButton.addEventListener('click', () => {
        clearInterval(countdown);
        remainingTime = 180; // Reinicia a 3 minutos por defecto
        isPaused = false; // Restablece la pausa
        updateDisplay();
    });

    // Agrega un evento para pausar o reanudar el temporizador
    pauseButton.addEventListener('click', () => {
        isPaused = !isPaused;
    });

    function updateDisplay() {
        const minutes = Math.floor(remainingTime / 60);
        const seconds = remainingTime % 60;
        minutesDisplay.textContent = minutes < 10 ? '0' + minutes : minutes;
        secondsDisplay.textContent = seconds < 10 ? '0' + seconds : seconds;
        timerInput.value = remainingTime;
    }
}

window.onload = function () {
    startTimer();
};



// ARRASTRAR TIMER
let isDragging = false;
let offsetX, offsetY;

const timer = document.getElementById("timer");

timer.addEventListener("mousedown", (e) => {
    isDragging = true;
    offsetX = e.clientX - timer.getBoundingClientRect().left;
    offsetY = e.clientY - timer.getBoundingClientRect().top;
    timer.style.cursor = "grabbing";
});

document.addEventListener("mousemove", (e) => {
    if (isDragging) {
        const x = e.clientX - offsetX;
        const y = e.clientY - offsetY;
        timer.style.left = x + "px";
        timer.style.top = y + "px";
    }
});

document.addEventListener("mouseup", () => {
    isDragging = false;
    timer.style.cursor = "grab";
});


$(document).ready(function () {
    $("#startTimer").click(function () {
        $("#timer").toggle(); // Alternar la visibilidad del temporizador al hacer clic en el botón
    });
});




//COLOR FONDO DE PANTALLA



// Agrega un manejador de eventos para las teclas de flecha izquierda y derecha
document.addEventListener('keydown', (e) => {
    switch (e.key) {
        case 'ArrowLeft':
            navigateImage(-1); // Retroceder a la imagen anterior
            break;
        case 'ArrowRight':
            navigateImage(1); // Avanzar a la siguiente imagen
            break;
    }
});

// Función para navegar entre imágenes
function navigateImage(direction) {
    if (images.length > 1) {
        currentImageIndex += direction;
        if (currentImageIndex < 0) {
            currentImageIndex = images.length - 1;
        } else if (currentImageIndex >= images.length) {
            currentImageIndex = 0;
        }
        loadNewImage(images[currentImageIndex]);
    }
}


// "Transición" IMÁGENES

const transitionButton = document.getElementById('transitionButton');
let transitionInterval;

// Agrega un manejador de eventos al botón "Transición"
transitionButton.addEventListener('click', () => {
    if (transitionInterval) {
        // Si la transición automática está activa, detenla al hacer clic nuevamente en el botón
        clearInterval(transitionInterval);
        transitionInterval = null;
        transitionButton.innerHTML = '<i class="fas fa-play"></i> Transición'; // Icono de "Play"
    } else {
        // Si la transición automática no está activa, comienza la transición cada 180 segundos
        transitionInterval = setInterval(() => {
            navigateImage(1); // Avanzar a la siguiente imagen
        }, 1000); // 180 segundos (3 minutos)
        transitionButton.innerHTML = '<i class="fas fa-pause"></i> Transición'; // Icono de "Pause"
    }
});






const startTransitionButton = document.getElementById('startTransitionButton');
const transitionDurationInput = document.getElementById('transitionDuration');

startTransitionButton.addEventListener('click', () => {
    const durationInSeconds = parseInt(transitionDurationInput.value, 10);
    
    if (!isNaN(durationInSeconds) && durationInSeconds > 0) {
        startTransition(durationInSeconds);
    } else {
        alert('Ingresa una duración válida en segundos.');
    }
});

function startTransition(durationInSeconds) {
    if (transitionInterval) {
        clearInterval(transitionInterval);
        transitionInterval = null;
        transitionButton.innerHTML = '<i class="fas fa-play"></i> Transición';
    } else {
        transitionInterval = setInterval(() => {
            navigateImage(1);
        }, durationInSeconds * 1000); // Multiplica por 1000 para convertir de segundos a milisegundos
        transitionButton.innerHTML = '<i class="fas fa-pause"></i> Transición';
    }
}


















</script>



</body>
</html>
